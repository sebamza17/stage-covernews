service: serverless

plugins:
  - serverless-webpack
  - serverless-offline

custom:
  webpack:
    webpackConfig: ./webpack.config.js
    includeModules: true

provider:
  name: aws
  runtime: nodejs8.10
  stage: prod
  region: us-east-1

functions:
  # ARTICLES SECCION
  getArticles:
    handler: article/article.get
    events:
      - http:
          path: article/all
          method: get
          cors: true
          authorizer: false
  showArticle:
    handler: article/article.show
    events:
      - http:
          path: article/show/{articleId}
          method: get
          cors: true
          authorizer: false
  showFullArticle:
    handler: article/article.getFullArticle
    events:
      - http:
          path: article/showFull/{articleId}
          method: get
          cors: true
          authorizer: false
  showArticleContent:
    handler: article/article.getArticleContent
    events:
      - http:
          path: article/content/{articleId}
          method: get
          cors: true
          authorizer: false
  getByCanonical:
    handler: article/article.getByCanonical
    events:
      - http:
          path: article/canonical/{canonical}
          method: get
          cors: true
          authorizer: false
  getArticlesByCategory:
      handler: article/article.getByCategory
      events:
        - http:
            path: article/category/{categoryId}
            method: get
            cors: true
            authorizer: false
  getArticlesByAuthor:
      handler: article/article.getByAuthor
      events:
        - http:
            path: article/author/{authorId}
            method: get
            cors: true
            authorizer: false
  searchArticles:
      handler: article/article.search
      events:
        - http:
            path: article/search/{criteria}
            method: get
            cors: true
            authorizer: false
# AUTHOR SECCION
  getAuthors:
    handler: author/author.get
    events:
      - http:
          path: author/all
          method: get
          cors: true
          authorizer: false
  showAuthor:
    handler: author/author.show
    events:
      - http:
          path: author/show/{authorId}
          method: get
          cors: true
          authorizer: false
  searchAuthors:
      handler: author/author.search
      events:
        - http:
            path: author/search/{criteria}
            method: get
            cors: true
            authorizer: false
  updateAuthor:
      handler: author/author-admin.update
      events:
        - http:
            path: author/update/{authorId}
            method: post
            cors: true
            authorizer: false 
  removeAuthor:
      handler: author/author-admin.remove
      events:
        - http:
            path: author/remove/{authorId}
            method: post
            cors: true
            authorizer: false   
  addAuthor:
      handler: author/author-admin.add
      events:
        - http:
            path: author/add
            method: post
            cors: true
            authorizer: false              
# CATEGORY SECCION
  getCategories:
    handler: category/category.get
    events:
      - http:
          path: category/all
          method: get
          cors: true
          authorizer: false
  showCategory:
    handler: category/category.show
    events:
      - http:
          path: category/show/{categoryId}
          method: get
          cors: true
          authorizer: false
  searchCategories:
      handler: category/category.search
      events:
        - http:
            path: category/search/{criteria}
            method: get
            cors: true
            authorizer: false
# USER SECCION
  refreshToken:
      handler: user/user.refreshToken
      events:
        - http:
            path: user/refreshToken
            method: post
            cors: true
            authorizer: false
  getByToken:
      handler: user/user.getByToken
      events:
        - http:
            path: user/getByToken
            method: post
            cors: true
            authorizer: false
  getFollowAuthors:
      handler: author/author-follow.get
      events:
        - http:
            path: author/follow
            method: get
            cors: true
            authorizer: false
# ADMIN SECCION
  loginAdmin:
      handler: admin/admin.login
      events:
        - http:
            path: admin/admin
            method: post
            cors: true
            authorizer: false